{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",

  "extends": [
    "config:recommended",
    "customManagers:dockerfileVersions",
    "helpers:pinGitHubActionDigests"
  ],

  "labels": ["renovate-dependencies"],

  "rebaseWhen": "conflicted",

  "ignorePaths": [
    "**/node_modules/**",
    "**/bower_components/**",
    "**/cypress/**"

  ],

  "packageRules": [
    {
      "matchManagers": ["gomod"],
      "groupName": "All Go dependencies",
      "rangeStrategy": "bump",
      "postUpdateOptions": ["gomodUpdateImportPaths"]
    },
    {
      "matchManagers": ["github-actions"],
      "groupName": "github actions",
      "separateMajorMinor": true,
      "prPriority": 5
    },
    {
      "matchManagers": ["pip_requirements"],
      "groupName": "python dependencies"
    },
    {
      "matchDatasources": ["terraform-provider"],
      "groupName": "terraform providers"
    },
    {
      "matchDatasources": ["docker"],
      "groupName": "docker images"
    },
    {
      "matchManagers": ["custom.regex"],
      "matchDatasources": ["docker"],
      "matchCurrentVersion": "v?\\d+\\.\\d+\\.\\d+",
      "versioning": "semver",
      "groupName": "custom docker images (loose) {{newVersion}}{{newDigest}}",
      "commitMessageTopic": "custom docker images (loose) {{newVersion}}{{newDigest}}",
      "commitMessageExtra": "",
      "separateMajorMinor": false,
      "pinDigests": true
    },
    {
    "matchManagers": ["custom.regex"],
    "matchDatasources": ["docker"],
    "versioning": "loose",
    "groupName": "custom docker images (loose) {{newVersion}}{{newDigest}}",
    "commitMessageTopic": "custom docker images (loose) {{newVersion}}{{newDigest}}",
    "commitMessageExtra": "",
    "separateMajorMinor": false,
    "maxMajorIncrement": 0
    }
  ],

  "customManagers": [
    {
      "customType": "regex",
      "managerFilePatterns": [
        "/.ya?ml$/",
        "/.sh$/",
        "/.json$/",
        "/.tf$/",
        "/.tfvars$/"
      ],
      "matchStrings": [
        "(?<depName>(?:[a-z0-9.-]+\\.)?[a-z0-9.-]+/[a-z0-9._/-]+):(?<currentValue>v?[0-9][a-z0-9._-]*)(?:@(?<currentDigest>sha256:[a-f0-9]+))?"
      ],
      "datasourceTemplate": "docker"
    }
  ]
}